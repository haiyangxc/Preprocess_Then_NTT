#include "inttypes.h"
#include "ntt.h"
#include "params.h"

/* Precomputed NTT contants generated by Python script as follows:*/


#if (NEWHOPE_N == 512)
/************************************************************
* Name:        omegas_bitrev_montgomery
*
* Description: Contains powers of 128th root of unity in Montgomery 
*              domain with R=2^18 in bit-reversed order
************************************************************/
uint16_t omegas_bitrev_montgomery[64] = {
  990, 7427, 2634, 6819, 7103, 4400, 5538, 6586, 
  6362, 7197, 5382, 4345, 3858, 6086, 2025, 877, 
  1267, 7418, 671, 3583, 7143, 7338, 291, 6396, 
  1749, 5184, 1581, 5134, 3, 5213, 3639, 1906, 
  7548, 4441, 7653, 2552, 6719, 5383, 606, 729, 
  6097, 5015, 6539, 7524, 2461, 641, 4965, 1752, 
  6122, 4931, 6140, 5485, 274, 2459, 2079, 2539, 
  7190, 1957, 3535, 412, 2397, 2085, 4143, 2056
  };

/************************************************************
* Name:        omegas_inv_bitrev_montgomery
*
* Description: Contains inverses of powers of 128th root of unity 
*              in Montgomery domain with R=2^18 in bit-reversed order
************************************************************/
uint16_t omegas_inv_bitrev_montgomery[64] = {
990, 254, 862, 5047, 1095, 2143, 3281, 578, 
6804, 5656, 1595, 3823, 3336, 2299, 484, 1319, 
5775, 4042, 2468, 7678, 2547, 6100, 2497, 5932, 
1285, 7390, 343, 538, 4098, 7010, 263, 6414, 
5625, 3538, 5596, 5284, 7269, 4146, 5724, 491, 
5142, 5602, 5222, 7407, 2196, 1541, 2750, 1559, 
5929, 2716, 7040, 5220, 157, 1142, 2666, 1584, 
6952, 7075, 2298, 962, 5129, 28, 3240, 133
};

/************************************************************
* Name:        psis_bitrev_montgomery
*
* Description: Contains powers of 128th root of -1 in Montgomery 
*              domain with R=2^18 in bit-reversed order
************************************************************/
uint16_t psis_bitrev_montgomery[128] = {
  990, 7427, 2634, 6819, 7103, 4400, 5538, 6586, 
  6362, 7197, 5382, 4345, 3858, 6086, 2025, 877, 
  1267, 7418, 671, 3583, 7143, 7338, 291, 6396, 
  1749, 5184, 1581, 5134, 3, 5213, 3639, 1906, 
  7548, 4441, 7653, 2552, 6719, 5383, 606, 729, 
  6097, 5015, 6539, 7524, 2461, 641, 4965, 1752, 
  6122, 4931, 6140, 5485, 274, 2459, 2079, 2539, 
  7190, 1957, 3535, 412, 2397, 2085, 4143, 2056, 
  3995, 3475, 6905, 5987, 771, 3247, 5822, 5939, 
  7673, 4021, 5658, 38, 3465, 6792, 1538, 4664, 
  5074, 1693, 2281, 2782, 1010, 1215, 3851, 6724, 
  657, 4859, 5798, 2640, 594, 2920, 6189, 1019, 
  4390, 3684, 2137, 6031, 1549, 5856, 4773, 6084, 
  1289, 2121, 4314, 7319, 3375, 4022, 7583, 1251, 
  6239, 851, 2122, 3009, 485, 2979, 4549, 3457, 
  2635, 3436, 959, 4766, 6065, 5737, 6128, 7676
};

/************************************************************
* Name:         psis_inv_montgomery
*
* Description: Contains inverses of powers of 128th  root of -1 
*              divided by n in Montgomery domain with R=2^18
************************************************************/
uint16_t psis_inv_montgomery[128] = {
2048, 7381, 464, 7373, 6826, 5931, 5267, 3324, 6534, 33, 6401, 4028, 
7391, 4033, 5335, 3014, 3429, 1763, 1677, 4780, 800, 1323, 5942, 2280, 
7227, 3877, 6498, 5619, 7593, 853, 7181, 5894, 2047, 6256, 2204, 6218, 
5540, 3209, 55, 427, 4153, 2077, 1601, 3771, 2463, 5715, 378, 2795, 
2846, 6454, 2205, 7343, 3800, 4364, 1341, 3149, 1684, 4974, 3982, 1727, 
7263, 5972, 5306, 1113, 122, 6673, 2788, 2652, 3272, 1801, 6022, 108, 6285, 
4105, 1844, 630, 2098, 2183, 5636, 3675, 1997, 3773, 4713, 2235, 2688, 5367, 
609, 1516, 318, 4424, 7393, 6283, 1855, 5324, 6001, 7207, 4420, 2893, 5562, 
4916, 180, 2794, 1721, 513, 1050, 6057, 1078, 6833, 6125, 768, 3728, 174, 3725, 
4480, 1264, 1015, 5087, 530, 4813, 7201, 5351, 5652, 6313, 4881, 6891, 2246, 7382, 1589};

#elif (NEWHOPE_N == 1024)
/************************************************************
* Name:        omegas_bitrev_montgomery
*
* Description: Contains powers of 256th root of unity in Montgomery 
*              domain with R=2^18 in bit-reversed order
************************************************************/
uint16_t omegas_bitrev_montgomery[128] = {
  990, 7427, 2634, 6819, 578, 3281, 2143, 1095, 484, 6362, 3336, 5382, 6086, 3823, 877, 5656,
  3583, 7010, 6414, 263, 1285, 291, 7143, 7338, 1581, 5134, 5184, 5932, 4042, 5775, 2468, 3,
  606, 729, 5383, 962, 3240, 7548, 5129, 7653, 5929, 4965, 2461, 641, 1584, 2666, 1142, 157,
  7407, 5222, 5602, 5142, 6140, 5485, 4931, 1559, 2085, 5284, 2056, 3538, 7269, 3535, 7190, 1957,
  3465, 6792, 1538, 4664, 2023, 7643, 3660, 7673, 1694, 6905, 3995, 3475, 5939, 1859, 6910, 4434,
  1019, 1492, 7087, 4761, 657, 4859, 5798, 2640, 1693, 2607, 2782, 5400, 6466, 1010, 957, 3851,
  2121, 6392, 7319, 3367, 3659, 3375, 6430, 7583, 1549, 5856, 4773, 6084, 5544, 1650, 3997, 4390,
  6722, 2915, 4245, 2635, 6128, 7676, 5737, 1616, 3457, 3132, 7196, 4702, 6239, 851, 2122, 3009
};

/************************************************************
* Name:         omegas_inv_bitrev_montgomery
*
* Description: Contains inverses of powers of 256th root of unity 
*              in Montgomery domain with R=2^18 in bit-reversed order
************************************************************/
uint16_t omegas_inv_bitrev_montgomery[128] = {
  990, 254, 862, 5047, 6586, 5538, 4400, 7103, 2025, 6804, 3858, 1595, 2299, 4345, 1319, 7197,
  7678, 5213, 1906, 3639, 1749, 2497, 2547, 6100, 343, 538, 7390, 6396, 7418, 1267, 671, 4098,
  5724, 491, 4146, 412, 4143, 5625, 2397, 5596, 6122, 2750, 2196, 1541, 2539, 2079, 2459, 274,
  7524, 6539, 5015, 6097, 7040, 5220, 2716, 1752, 28, 2552, 133, 4441, 6719, 2298, 6952, 7075,
  4672, 5559, 6830, 1442, 2979, 485, 4549, 4224, 6065, 1944, 5, 1553, 5046, 3436, 4766, 959,
  3291, 3684, 6031, 2137, 1597, 2908, 1825, 6132, 98, 1251, 4306, 4022, 4314, 362, 1289, 5560,
  3830, 6724, 6671, 1215, 2281, 4899, 5074, 5988, 5041, 1883, 2822, 7024, 2920, 594, 6189, 6662,
  3247, 771, 5822, 1742, 4206, 3686, 776, 5987, 8, 4021, 38, 5658, 3017, 6143, 889, 4216
  };

/************************************************************
* Name:        psis_bitrev_montgomery
*
* Description: Contains powers of 256th root of -1 in Montgomery 
*              domain with R=2^18 in bit-reversed order
************************************************************/
uint16_t psis_bitrev_montgomery[256] = {
  990, 7427, 2634, 6819, 578, 3281, 2143, 1095, 484, 6362, 3336, 5382, 6086, 3823, 877, 5656,
  3583, 7010, 6414, 263, 1285, 291, 7143, 7338, 1581, 5134, 5184, 5932, 4042, 5775, 2468, 3,
  606, 729, 5383, 962, 3240, 7548, 5129, 7653, 5929, 4965, 2461, 641, 1584, 2666, 1142, 157,
  7407, 5222, 5602, 5142, 6140, 5485, 4931, 1559, 2085, 5284, 2056, 3538, 7269, 3535, 7190, 1957,
  3465, 6792, 1538, 4664, 2023, 7643, 3660, 7673, 1694, 6905, 3995, 3475, 5939, 1859, 6910, 4434,
  1019, 1492, 7087, 4761, 657, 4859, 5798, 2640, 1693, 2607, 2782, 5400, 6466, 1010, 957, 3851,
  2121, 6392, 7319, 3367, 3659, 3375, 6430, 7583, 1549, 5856, 4773, 6084, 5544, 1650, 3997, 4390,
  6722, 2915, 4245, 2635, 6128, 7676, 5737, 1616, 3457, 3132, 7196, 4702, 6239, 851, 2122, 3009,
  7613, 7295, 2007, 323, 5112, 3716, 2289, 6442, 6965, 2713, 7126, 3401, 963, 6596, 607, 5027,
  7078, 4484, 5937, 944, 2860, 2680, 5049, 1777, 5850, 3387, 6487, 6777, 4812, 4724, 7077, 186,
  6848, 6793, 3463, 5877, 1174, 7116, 3077, 5945, 6591, 590, 6643, 1337, 6036, 3991, 1675, 2053,
  6055, 1162, 1679, 3883, 4311, 2106, 6163, 4486, 6374, 5006, 4576, 4288, 5180, 4102, 282, 6119,
  7443, 6330, 3184, 4971, 2530, 5325, 4171, 7185, 5175, 5655, 1898, 382, 7211, 43, 5965, 6073,
  1730, 332, 1577, 3304, 2329, 1699, 6150, 2379, 5113, 333, 3502, 4517, 1480, 1172, 5567, 651,
  925, 4573, 599, 1367, 4109, 1863, 6929, 1605, 3866, 2065, 4048, 839, 5764, 2447, 2022, 3345,
  1990, 4067, 2036, 2069, 3567, 7371, 2368, 339, 6947, 2159, 654, 7327, 2768, 6676, 987, 2214
  };

/************************************************************
* Name:        psis_inv_montgomery
*
* Description: Contains inverses of powers of 256th  root of -1 
*              divided by n in Montgomery domain with R=2^18
************************************************************/
uint16_t psis_inv_montgomery[256] = {
  1024, 4972, 5779, 6907, 4943, 4168,  315, 5580,   90,  497, 1123,  142, 4710, 5527, 2443, 4871, 
   698, 2489, 2394, 4003,  684, 2241, 2390, 7224, 5072, 2064, 4741, 1687, 6841,  482, 7441, 1235, 
  2126, 4742, 2802, 5744, 6287, 4933,  699, 3604, 1297, 2127, 5857, 1705, 3868, 3779, 4397, 2177, 
   159,  622, 2240, 1275,  640, 6948, 4572, 5277,  209, 2605, 1157, 7328, 5817, 3191, 1662, 2009, 
  4864,  574, 2487,  164, 6197, 4436, 7257, 3462, 4268, 4281, 3414, 4515, 3170, 1290, 2003, 5855, 
  7156, 6062, 7531, 1732, 3249, 4884, 7512, 3590, 1049, 2123, 1397, 6093, 3691, 6130, 6541, 3946, 
  6258, 3322, 1788, 4241, 4900, 2309, 1400, 1757,  400,  502, 6698, 2338, 3011,  668, 7444, 4580, 
  6516, 6795, 2959, 4136, 3040, 2279, 6355, 3943, 2913, 6613, 7416, 4084, 6508, 5556, 4054, 3782, 
    61, 6567, 2212,  779,  632, 5709, 5667, 4923, 4911, 6893, 4695, 4164, 3536, 2287, 7594, 2848, 
  3267, 1911, 3128,  546, 1991,  156, 4958, 5531, 6903,  483,  875,  138,  250, 2234, 2266, 7222, 
  2842, 4258,  812, 6703,  232, 5207, 6650, 2585, 1900, 6225, 4932, 7265, 4701, 3173, 4635, 6393, 
   227, 7313, 4454, 4284, 6759, 1224, 5223, 1447,  395, 2608, 4502, 4037,  189, 3348,   54, 6443, 
  2210, 6230, 2826, 1780, 3002, 5995, 1955, 6102, 6045, 3938, 5019, 4417, 1434, 1262, 1507, 5847, 
  5917, 7157, 7177, 6434, 7537,  741, 4348, 1309,  145,  374, 2236, 4496, 5028, 6771, 6923, 7421, 
  1978, 1023, 3857, 6876, 1102, 7451, 4704, 6518, 1344,  765,  384, 5705, 1207, 1630, 4734, 1563, 
  6839, 5933, 1954, 4987, 7142, 5814, 7527, 4953, 7637, 4707, 2182, 5734, 2818,  541, 4097, 5641
  };

#else 
#error "NEWHOPE_N must be either 512 or 1024"
#endif
