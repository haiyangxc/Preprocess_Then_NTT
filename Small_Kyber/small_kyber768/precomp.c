#include "inttypes.h"
#include "ntt.h"
#include "params.h"

/* Precomputed constants for the forward NTT and inverse NTT.
 * Computed using Pari/GP as follows:
 *
brv=[0,128,64,192,32,160,96,224,16,144,80,208,48,176,112,240, \
     8,136,72,200,40,168,104,232,24,152,88,216,56,184,120,248, \
     4,132,68,196,36,164,100,228,20,148,84,212,52,180,116,244, \
     12,140,76,204,44,172,108,236,28,156,92,220,60,188,124,252, \
     2,130,66,194,34,162,98,226,18,146,82,210,50,178,114,242, \
     10,138,74,202,42,170,106,234,26,154,90,218,58,186,122,250, \
     6,134,70,198,38,166,102,230,22,150,86,214,54,182,118,246, \
     14,142,78,206,46,174,110,238,30,158,94,222,62,190,126,254, \
     1,129,65,193,33,161,97,225,17,145,81,209,49,177,113,241, \
     9,137,73,201,41,169,105,233,25,153,89,217,57,185,121,249, \
     5,133,69,197,37,165,101,229,21,149,85,213,53,181,117,245, \
     13,141,77,205,45,173,109,237,29,157,93,221,61,189,125,253, \
     3,131,67,195,35,163,99,227,19,147,83,211,51,179,115,243, \
     11,139,75,203,43,171,107,235,27,155,91,219,59,187,123,251, \
     7,135,71,199,39,167,103,231,23,151,87,215,55,183,119,247, \
     15,143,79,207,47,175,111,239,31,159,95,223,63,191,127,255];

q = 7681;
n = 256;
mont = Mod(2^18,q);

g=0; for(i=2,q-1,if(znorder(Mod(i,q)) == 2*n, g=Mod(i,q); break))

zetas = lift(vector(n, i, g^(brv[i])*mont))
omegas_inv_bitrev_montgomery = lift(vector(n/2, i, (g^2)^(-brv[2*(i-1)+1])*mont))
psis_inv_montgomery = lift(vector(n, i, g^(-(i-1))/n*mont))

*/

const uint16_t zetas[128]={
2482, 297, 1893, 590, 2643, 2359, 1148, 808, 2645, 2488, 2979, 728, 519, 1850, 762, 2543, 2292, 1358, 1056, 1532, 13, 2503, 250, 2809, 605, 739, 2928, 2432, 490, 1644, 2509, 374, 1563, 2608, 1121, 731, 1486, 2635, 2201, 482, 2064, 3297, 2049, 665, 186, 2010, 504, 2547, 3246, 2969, 2245, 3320, 428, 974, 2341, 2854, 1737, 515, 626, 429, 1792, 2398, 2708, 1558, 2246, 1720, 2220, 43, 1654, 155, 2871, 420, 1688, 2348, 708, 2389, 2165, 1489, 2967, 3283, 2345, 3112, 1307, 2741, 221, 2603, 921, 1147, 298, 2576, 3170, 1396, 1672, 1316, 2705, 3029, 3268, 1059, 2412, 2440, 1959, 1518, 798, 1536, 1798, 2785, 1543, 1318, 3162, 880, 1910, 22, 1918, 538, 1546, 3176, 618, 3242, 3178, 1912, 2897, 2097, 655, 635, 503, 818, 2759, 3183};


 const uint16_t omegas_inv_bitrev_montgomery[64] = {
2482, 3032, 2739, 1436, 2521, 2181, 970, 686, 786, 2567, 1479, 2810, 2601, 350, 841, 684, 2955, 820, 1685, 2839, 897, 401, 2590, 2724, 520, 3079, 826, 3316, 1797, 2273, 1971, 1037, 1771, 621, 931, 1537, 2900, 2703, 2814, 1592, 475, 988, 2355, 2901, 9, 1084, 360, 83, 782, 2825, 1319, 3143, 2664, 1280, 32, 1265, 2847, 1128, 694, 1843, 2598, 2208, 721, 1766};


 const uint16_t psis_inv_montgomery[128] ={
2048, 2862, 560, 2187, 3066, 572, 2971, 2133, 2867, 3106, 966, 3190, 3125, 3317, 2545, 933, 1034, 3194, 1167, 3006, 3310, 978, 645, 2192, 2283, 2680, 3095, 1357, 3213, 189, 2361, 1118, 2024, 1294, 2426, 926, 2796, 2906, 2325, 2095, 1494, 1067, 2021, 1098, 1827, 2849, 1930, 701, 1412, 1258, 74, 396, 2569, 2501, 2497, 1126, 1437, 672, 627, 1016, 2018, 902, 1228, 1443, 1064, 1825, 499, 421, 1983,3054, 3117, 575, 3167, 2732, 944, 643, 3171, 774, 633, 1408, 3216, 385, 2960, 2524, 2890, 170, 10, 1763, 887, 248, 1777, 692, 824, 2790, 2514, 1127, 2612, 3091, 3315, 195, 2753, 2316, 1507, 3026, 178, 2752, 1141, 2417, 338, 999, 2017, 3056, 2138, 2084, 1885, 1090, 2414, 142, 400, 611, 2190, 3262, 1171, 1048, 2999, 1743, 690, 1803};
